{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Maestranza</title>
</head>
<body>
    <!-- MENÃš -->
    <nav class="navbar navbar-expand-md navbar-dark menu">
        <a class="navbar-brand" href="{% url 'MenuPrincipal' %}">Maestranza</a>
        <div class="collapse navbar-collapse" id="collapsibleNavbar">
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'Herramientas' %}">Herramientas</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'Sesion' %}">Iniciar SesiÃ³n</a>
                </li>
            </ul>
        </div>
    </nav>
    <div class="container" id="container">
        <!--Registro-->
        <div class="form-container sign-up-container">
            <form action="{% url 'registrar' %}" method="post" id="regis" onsubmit="return validarRut()">
                {% csrf_token %}
                <h1>Registrate </h1>
                <span>Usa tu correo electrÃ³nico para registrarte ðŸ¤”</span>

                
                    <input type="text" name="rut" id="rut"  placeholder="Ingresa tu Rut sin puntos pero con guion" />
                    <input type="text" name="name"  placeholder="Ingresa tu Nombre " /> 
                    <input type="text" name="direccion" placeholder="Ingresa tu DirecciÃ³n" /> 
                    <input type="email" name="correo" placeholder="Ingresa tu Correo electrÃ³nico" />
                    <input type="number" name="telefono" placeholder="Ingresa tu Telefono " />
                    <input type="password" name="password"  placeholder="Ingresa tu ContraseÃ±a" />
                
                <select name="pregunta">
                    <option selected>Selecciona una pregunta de Seguridad</option>
                    {% for pregunta in preguntas %}
                        <option value="{{ pregunta.id_preg }}">{{ pregunta.nombre_preg }}</option>
                    {% endfor %}
                </select>
                <input type="text" name="rs" id="resp" placeholder="Respuesta de Seguridad " />
                <button>Registrarse </button>

                <p id="rutError" style="color: red; display: none;">El RUT ingresado no es vÃ¡lido.</p>
            </form>
             <!--Fin de formulario de Registro-->
        </div>

         <!--InicioSesion-->
        <div class="form-container sign-in-container">
            <form method="post" action="{% url 'iniciarsesion' %}">
                {% csrf_token %}
                <h1>Iniciar sesiÃ³n</h1>
                <span>Usa tu cuenta para iniciar sesiÃ³n ðŸ¤—</span>
                <input type="email" name="correo" placeholder="Correo electrÃ³nico" required>
                <input type="password" name="clave" placeholder="ContraseÃ±a" required>
                <a href="olvidocontraseÃ±a.html">Â¿Olvidaste tu contraseÃ±a?</a>
                <button type="submit">Iniciar sesiÃ³n</button>
            </form>     
            
        </div>
        <!--Fin de formulario de InicioSesion-->

        <!--Interfaces de Hola contructor-->
        <div class="overlay-container">
            <div class="overlay">
                <div class="overlay-panel overlay-left">
                    <h1>Â¡Bienvenido de nuevo, Constructor ! ðŸ”¨</h1>
                    <p>Para seguir conectado con nuestro mundo de herramientas, por favor inicia sesiÃ³n con tu informaciÃ³n personal.</p>
                    <button class="ghost" id="signIn">Iniciar sesiÃ³n</button>
                </div>
                <div class="overlay-panel overlay-right">
                    <h1>Â¡ Hola Constructor ! ðŸ”¨</h1>
                    <p>âœ¨ Tu taller de sueÃ±os te espera. âœ¨</p>
                    <button class="ghost" id="signUp">Â¡ Registrate !</button>
                </div>
            </div>
        </div>
        <!-- Fin de Interfaces de Hola contructor-->
    </div>

    <!-- CSS Y JS -->
    <link rel="stylesheet" href="{% static 'css/inicioseccion.css' %}">
    <script src="{% static 'javascript/inicioseccion.js' %}"></script>
    <script>
        function validarRut() {
            var rut = document.getElementById('rut').value.trim();
            console.log("RUT ingresado:", rut);
    
            // Validar formato bÃ¡sico del RUT (nÃºmeros y dÃ­gito verificador)
            var regex = /^[0-9]+-[0-9kK]{1}$/;
            if (!regex.test(rut)) {
                console.log("Formato de RUT no vÃ¡lido.");
                document.getElementById('rutError').style.display = 'block';
                return false;
            }
    
            // Validar RUT usando algoritmo
            var cleanRut = rut.replace(/[\.\-]/g, '');  // Eliminar puntos y guiones
            console.log("RUT limpio:", cleanRut);
    
            var dv = cleanRut.slice(-1).toUpperCase();  // Obtener dÃ­gito verificador
            console.log("DÃ­gito verificador ingresado:", dv);
    
            var rutNumber = parseInt(cleanRut.slice(0, -1), 10);  // Obtener parte numÃ©rica del RUT
            console.log("NÃºmero de RUT:", rutNumber);
    
            var suma = 0;
            var mul = 2;
            for (var i = rutNumber.toString().length - 1; i >= 0; i--) {
                suma = suma + rutNumber.toString().charAt(i) * mul;
                mul++;
                if (mul == 8) {
                    mul = 2;
                }
            }
    
            var res = suma % 11;
            var digitoVerificador = res == 0 ? 0 : 11 - res;
            console.log("DÃ­gito verificador calculado:", digitoVerificador);
    
            if (!(dv == digitoVerificador || (dv == 'K' && digitoVerificador == 10))) {
                console.log("El RUT no es vÃ¡lido.");
                document.getElementById('rutError').style.display = 'block';
                return false;
            }
    
            console.log("El RUT es vÃ¡lido.");
            return true;
        }
    </script>
    

    <!-- carrito-->

</body>
<footer>
    <p>&copy; 2024 Tienda Online. Todos los derechos reservados.</p>
</footer>
</html>
